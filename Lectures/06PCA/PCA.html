<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Principal Components Analysis</title>
    <meta charset="utf-8" />
    <meta name="author" content="Anastasios Panagiotelis &amp; Ruben Loaiza-Maya" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/pymjs/pym.v1.js"></script>
    <script src="libs/widgetframe-binding/widgetframe.js"></script>
    <link rel="stylesheet" href="mtheme.css" type="text/css" />
    <link rel="stylesheet" href="mod.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Principal Components Analysis
## High Dimensional Data Analysis
### Anastasios Panagiotelis &amp; Ruben Loaiza-Maya
### Lecture 6

---


class: inverse, center, middle

# Motivation



---

# High Dimensional Data

- In **marketing** surveys we may ask a large number of questions about customer experience.&lt;!--D--&gt;
--

- In **finance** there may be several ways to assess the credit worthiness of firms.&lt;!--D--&gt;
--

- In **economics** the development of a country or state can be measured in different ways.

---

# A real example

- Consider a dataset with the following variables for the 50 States of the USA&lt;!--D--&gt;
--

  + Income
  + Illiteracy
  + Life Expectancy
  + Murder Rate
  + High School Graduation Rate&lt;!--D--&gt;
--

- You can access this via moodle from the file *StateSE.rds*&lt;!--D--&gt;

---

# Summarising many variables

- Often we aim to combine many variables into a single index&lt;!--D--&gt;
--

  + In finance a credit score summarises all the information about the likelihood of bankruptcy for a company.&lt;!--D--&gt;
--

  + In marketing we require a single overall measure of customer experience.&lt;!--D--&gt;
--

  + In economics the Human Development Index is a single measure that takes income, education and health into account.

---

# Weighted linear combination

- A convenient way to combine variables is through a *linear combination* (LC)&lt;!--D--&gt;
--

  + For example, your grade for this unit:
$$ 
w_1\mbox{Assign. Marks}+w_2\mbox{Exam Mark}
$$
  + Here `\(w_1\)` and `\(w_2\)` are called *weights*
  + In this unit, the  weight for the Assignments is *50%* and for the Examination is *50%*&lt;!--D--&gt;
--

- What is a good way to choose weights?

---

# Maximise variance

- The purpose of grading students is to differentiate the best perfoming students from the weakest performing students &lt;!--D--&gt;
--

- The index should have *large variance*.&lt;!--D--&gt;
--

- The LC with the highest variance is the **first Principal Component** of the data.&lt;!--D--&gt;
--

- The first principal component is a new variable that *explains* as much variance as possible in the original variables.

---

# Original Data

&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "&gt;&lt;table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; State &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Income &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Illiteracy &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; LifeExp &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; Murder &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; HSGrad &lt;/th&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; StateAbb &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alabama &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3624 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.05 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 41.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AL &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alaska &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6315 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.31 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AK &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Arizona &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4530 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 58.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AZ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Arkansas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3378 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AR &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; California &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5114 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.71 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 62.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Colorado &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4884 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.06 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CO &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Connecticut &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5348 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CT &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Delaware &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4809 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.06 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; DE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Florida &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4815 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; FL &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Georgia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4091 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 68.54 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; GA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hawaii &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4963 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73.60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 61.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; HI &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Idaho &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4119 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ID &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Illinois &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5107 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; IL &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Indiana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4458 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.88 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; IN &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Iowa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4628 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.56 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; IA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Kansas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4669 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KS &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Kentucky &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3712 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 38.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; KY &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Louisiana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3545 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 68.76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; LA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Maine &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3694 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.39 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ME &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Maryland &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5299 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MD &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Massachusetts &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4755 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.83 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 58.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Michigan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4751 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.63 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MI &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Minnesota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4675 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MN &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mississippi &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3098 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 68.09 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 41.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MS &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Missouri &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4254 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MO &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Montana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4347 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.56 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; MT &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nebraska &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4508 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nevada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5149 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.03 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NV &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Hampshire &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4281 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NH &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Jersey &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5237 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.93 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NJ &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Mexico &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3601 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NM &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4903 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NY &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; North Carolina &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3875 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 38.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NC &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; North Dakota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5087 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.78 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ND &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ohio &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4561 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.82 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OH &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oklahoma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3983 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 51.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OK &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oregon &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4660 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; OR &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pennsylvania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4449 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.43 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Rhode Island &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4558 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.90 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; RI &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; South Carolina &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3635 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; SC &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; South Dakota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4167 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.08 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; SD &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tennessee &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3821 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 41.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TN &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Texas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4188 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.90 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TX &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Utah &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4022 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.90 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UT &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Vermont &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3907 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.64 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; VT &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Virginia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4701 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.08 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; VA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Washington &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4864 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; WA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; West Virginia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3617 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 41.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; WV &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wisconsin &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4468 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; WI &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wyoming &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4566 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 62.9 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; WY &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---

# First PC

&lt;div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; "&gt;&lt;table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"&gt; State &lt;/th&gt;
   &lt;th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"&gt; .fittedPC1 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alabama &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.4736429 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Alaska &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5523458 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Arizona &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.3218179 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Arkansas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.3518240 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; California &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9138319 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Colorado &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.7319349 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Connecticut &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.8293070 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Delaware &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3708443 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Florida &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4071974 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Georgia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.2000232 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hawaii &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3275139 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Idaho &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.2443096 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Illinois &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0586612 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Indiana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4059830 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Iowa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.1960892 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Kansas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9256885 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Kentucky &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.2652570 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Louisiana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.8826563 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Maine &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4547571 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Maryland &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.2844478 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Massachusetts &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.3868972 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Michigan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.1768465 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Minnesota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.2025281 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mississippi &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -4.0362219 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Missouri &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.3652702 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Montana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9359256 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nebraska &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.0060961 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nevada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4719808 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Hampshire &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.1727342 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Jersey &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7618589 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New Mexico &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.6465196 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; New York &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4937635 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; North Carolina &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.7036034 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; North Dakota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9049237 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ohio &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3444655 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oklahoma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0227251 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Oregon &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.8066483 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pennsylvania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0242343 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Rhode Island &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.5548203 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; South Carolina &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -3.7722712 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; South Dakota &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.5131049 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tennessee &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -2.1379510 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Texas &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.8743614 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Utah &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.0995090 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Vermont &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.8805572 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Virginia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.8810536 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Washington &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.9687535 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; West Virginia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -1.7131805 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wisconsin &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.5728437 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wyoming &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9429316 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---

# First PC on Map

&lt;img src="PCA_files/figure-html/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /&gt;

---

# Second Principal Component

- Sometimes a single index still oversimplifies the data.&lt;!--D--&gt;
--

- The second principal component is an LC that&lt;!--D--&gt;
--

  1. Is uncorrelated with the first PC.
  2. Has the highest variance out of all LCs that satisfy condition 1.&lt;!--D--&gt;
--

-  Since there is no need for PC2 to *explain* any variance already explained by PC1, PC2 and PC1 are uncorrelated.&lt;!--D--&gt;
--

- We can plot the first two principal components on a scatter plot.

---

# Scatter-plot of PCs

<div id="htmlwidget-1cd33921d68f8c1a7319" style="width:100%;height:100%;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1cd33921d68f8c1a7319">{"x":{"url":"PCA_files/figure-html//widgets/widget_unnamed-chunk-3.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>

---

# The weights

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; PC1 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; PC2 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Income &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3473146 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.7315324 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Illiteracy &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4803318 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0693093 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; LifeExp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4685523 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.3243911 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Murder &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4594049 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4916219 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HSGrad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4669687 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3363552 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
- A high (low) weight indicates a strong positive (negative)
association between a variable and the corresponding PC.

---

# Biplot

- The weight vectors can be plotted on the same scatterplot as
the data.&lt;!--D--&gt;
--

- This is called a biplot.&lt;!--D--&gt;
--

- We can do several useful things with a biplot&lt;!--D--&gt;
--

  + See how the observations relate to one another
  + See how the variables relate to one another
  + See how the observations relate to the variables
  
---

# Types of biplot

- There are multiple ways to draw a biplot.&lt;!--D--&gt;
--

- We will look at two versions&lt;!--D--&gt;
--

  + Distance Biplot
  + Correlation Biplot

---

# Distance Biplot

&lt;img src="PCA_files/figure-html/dbiplot-1.png" style="display: block; margin: auto;" /&gt;

---

# Distance Biplot

- The distance between observations implies similarity between observations&lt;!--D--&gt;
--

   + Louisiana (LA) and South Carolina (SC) are close therefore are similar.
   + Arkansas (AR) and California (CA) are far apart and therefore different.&lt;!--D--&gt;
--

- If the variables are ignored this is identical to a scatter plot of principal components.

---

# Correlation Biplot

&lt;img src="PCA_files/figure-html/cbiplot-1.png" style="display: block; margin: auto;" /&gt;

---

# Correlations

&lt;table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Income &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Illiteracy &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; LifeExp &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Murder &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; HSGrad &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Income &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.437 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.230 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.620 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Illiteracy &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.437 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.703 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.657 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; LifeExp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.340 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.588 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.781 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.582 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Murder &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.230 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.703 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.781 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.488 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HSGrad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.620 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.657 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.582 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.488 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.000 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Correlation Biplot

- The angles between variables tell us something about correlation (approximately)
  + Income and HSGrad are highly positively correlated.  The angle between them is close to zero.
  + LifeExp and Income are close to uncorrelated.  The angle between them is close 90 degrees.
  + Murder and LifeExp are highly negatively correlated.  The angle between them is close 180 degrees.

---

# More comparison

- The biplot also allows us to compare observations to variables.&lt;!--D--&gt;
--

- Think of the variables as axes.&lt;!--D--&gt;
--

- Draw the shortest line from each point to the axis.&lt;!--D--&gt;
--

- The position along that axis gives an approximation to the actual value of the variable for that observation.

---

# Biplot

&lt;img src="PCA_files/figure-html/dbiplot2-1.png" style="display: block; margin: auto;" /&gt;

---

# More PCs

- We can find a third PC, which has the highest variance, while
being uncorrelated with PC1 and PC2.&lt;!--D--&gt;
--

- We cannot visualise this with a biplot, but there are alternatives depending on the structure of the data.&lt;!--D--&gt;
--

- Now a time series example where we consider 3
principal components.

---

# A Time Series Example

- The Stock and Watson dataset contains data on 109
macroeconomic variables in the following categories&lt;!--D--&gt;
--

  + Output
  + Prices
  + Labour
  + Finance&lt;!--D--&gt;
--

- One cannot look at 109 time series plots to visualise general
macroeconomic conditions.&lt;!--D--&gt;
--

- However, one can look at time series plots of the principal
components of these variables.

---

# Plots of PCs

&lt;img src="PCA_files/figure-html/sw-1.png" style="display: block; margin: auto;" /&gt;

---

# All PCs

- There are as many principal components as there are variables.
- Together all `\(p\)` principal components explain all of the variation in all `\(p\)` original variables.
`$$\sum_{j=1}^p \mbox{Var}(C_j)=\sum_{j=1}^p \mbox{Var}(Y_j)$$`
- Where `\(C_j\)` is principal component `\(j\)` and `\(Y_j\)` is variable `\(j\)`
---

#So why PCs

- However a small number of principal components can often explain a large proportion of the variance&lt;!--D--&gt;
--

  + In the first example, 2 PCs explain 84% of the total variation of 5 variables.&lt;!--D--&gt;
--

  + In our second example, 3 PCs explain 35% of the total variation of 109 variables.

---
   
# Summary

- Principal components analysis is useful for&lt;!--D--&gt;
--

  + Creating a single index&lt;!--D--&gt;
--

  + Seeing how variables are associated with observations on a single biplot.&lt;!--D--&gt;
--

  + Visualising high-dimensional time series.&lt;!--D--&gt;
--

- How do we do it?

---
class: inverse, middle, center

# Implementation of PCA

---

# Restriction

- Recall that the objective is to find an LC with a large variance.  How could we ‘cheat’ ?&lt;!--D--&gt;
--

  + For a single variable `\(\mbox{Var}(wY) = w^2 \mbox{Var}(Y)\)` &lt;!--D--&gt;
--

  + The variance can be made large by choosing a huge value of `\(w\)`.&lt;!--D--&gt;
--

- For this reason the following restriction (normalization) is used
`$$w_1^2 + w_2^2 \ldots + w_p^2 = 1.$$`

---

# Standardisation

- A similar logic applies to the units that the variables are
measured in.&lt;!--D--&gt;
--

- In the states dataset, income varies from $3000
to $6000, life expectancy varies from 67 years to 73
years.&lt;!--D--&gt;
--

  + Which variable will probably have the larger variance?&lt;!--D--&gt;
--

- Income likely to have a larger variance.

---

# Different units

- If income is measured in $ ’000s then it will vary from about 3
to 6
--

- If Life Expectancy in measured in days rather than years
it will vary from about 24800 days to 26900 days&lt;!--D--&gt;
--

  + Which variable will have the larger variance now?&lt;!--D--&gt;
--

- The weights can be influenced by the units of measurement.

---

# Effect of standardisation

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Unstd &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; DifUnits &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Income &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.3473 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.0000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0004 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Illiteracy &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4803 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0004 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0007 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; LifeExp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4686 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0007 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.9999 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Murder &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.4594 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0014 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.0059 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HSGrad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.4670 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0081 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.0096 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Standardise or not?

- While the normalisation `\(w_1^2 + w_2^2+\ldots+ w_p^2 = 1\)` is always
implemented in any software that does PCA, the decision to
standardise is up to you.&lt;!--D--&gt;
--

- If the variables are measured in the *same* units then
  + *No* need to standardise.&lt;!--D--&gt;
--

- If the variables are measured in the *different* units then
  + *Standardise* the data.

---
    
# Principal Components in R

- There are several functions for doing Principal Components
Analysis in R. We will use `prcomp`&lt;!--D--&gt;
--

- We can scale in two ways&lt;!--D--&gt;
--

  + Scale the data using the function scale
  + Include the option `scale.=TRUE` when calling the function `prcomp`&lt;!--D--&gt;
--

- Now we will do PCA on the states dataset using R    

---

# Principal Components in R


```r
StateSE%&gt;%
  select_if(is.numeric)%&gt;% #Only use numeric variables
  prcomp(scale. = TRUE)-&gt;pca #Do pca 
summary(pca) #summary of information
```

```
## Importance of components:
##                           PC1    PC2    PC3     PC4     PC5
## Standard deviation     1.7892 0.9686 0.6317 0.55561 0.39093
## Proportion of Variance 0.6403 0.1876 0.0798 0.06174 0.03057
## Cumulative Proportion  0.6403 0.8279 0.9077 0.96943 1.00000
```

---

# Principal Components in R

- The output of the `prcomp` function is a prcomp object. &lt;!--D--&gt;
--

- It is a list that contains a lot of information.  Of most interest are&lt;!--D--&gt;
--

  + The principal components which are stored in `x`
  + The weights which are stored in `rotation`


---

# Biplot

- The biplot can be produced by:


```r
biplot(pca)
```

- To have the state abbreviations on the plot they need to be attached to the matrix `pca$x`


```r
rownames(pca$x)&lt;-pull(StateSE,StateAbb)
biplot(pca)
```

- Try it!

---

# Correlation biplot

- By default `biplot` produces the distance biplot.
- To produce the correlation biplot try

```r
biplot(pca,scale = 0)
```

---

# Scree Plot

- Another plot that is easy to create is the Scree plot.&lt;!--D--&gt;
--

- Along the horizontal axis is the Principal Component.&lt;!--D--&gt;
--

- Along the vertical axis is the variance corresponding to each
Principal Component.&lt;!--D--&gt;
--

- The Scree plot indicates how much each PC explains the total
variance of the data.&lt;!--D--&gt;
--


```r
screeplot(pca,type="lines")
```

---

# Scree Plot

&lt;img src="PCA_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---

# Selecting the number of PCs

- The Scree plot can be used to select the number of Principal
Components.&lt;!--D--&gt;
--

- Look for a part where the plot flattens out also called the
elbow of the Scree Plot.&lt;!--D--&gt;
--

- Another criterion used for standardised data is Kaiser’s Rule.
The rule is to select all PCs with a variance greater than 1.

---

# Number of PCs

- The way PCs are selected depend on the nature of the analysis.&lt;!--D--&gt;
--

- For a visualisation via the biplot, two PCs must be selected.&lt;!--D--&gt;
--

- In this case check the proportion of variance explained by those PCs&lt;!--D--&gt;
--

- The higher this number the more accurate the biplot

---

# PCA and MDS

- When the input distances to MDS are Euclidean MDS and PCA are equivalent.
--

- The usual caveat applies that these may only be exactly identical if the MDS solution is rotated.
--

- The same does not apply generally to PCA.  The first PC is defined to maximise variance.

---

# Interpreting PCs

- Remember that Principal Components do nothing more than find uncorrelated linear combinations of the variables that explain variance.
--

- Sometimes the nature of the data or analysis from a biplot might imply some sort of interpretation for the PCs.
--

- These interpretations can be subjective so be cautious.

---

# Towards Factor Analysis

- For survey data it is often the case that multiple survey questions are measures of the same underlying factor.&lt;!--D--&gt;
--

- For example, at the end of semester you evaluate this unit.  &lt;!--D--&gt;
--

- Typically you will be asked many questions.&lt;!--D--&gt;
--

- This is no different from any other customer satisfaction survey

---

# Underlying factors

- Although you are asked many questions perhaps there are two underlying factors that drive&lt;!--D--&gt;
--

  + The quality of the course materials
  + The quality of the teaching staff&lt;!--D--&gt;
--

- Perhaps the quality of assessment is a third factor.&lt;!--D--&gt;
--

- For survey data, Scree plots and Kaiser's rule can be used to select the number of underlying factors.

---

# To do

- These issues will be investigated in the topic on *Factor Modelling* which has some similarites (but also some important distinctions) when compared to PCA.
--

- Later on we will also look more deeply into PCA proving some important results.
--

- For now the primary objective is to understand what PCA does and how to implement it in R.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
